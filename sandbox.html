<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets Autocomplete Widget Sandbox</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        #widgetContainer {
            border: 1px solid #ccc;
            padding: 20px;
            margin-bottom: 20px;
            background-color: rgba(200, 200, 200, 0.1); /* Low opacity grey background */
        }
        #widgetFrame {
            width: 100%;
            border: none;
            height: 100px; /* Increased height for better visibility */
            transition: height 0.3s ease;
        }
        #controls {
            background-color: #f0f0f0;
            padding: 20px;
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input, select {
            width: 100%;
            padding: 5px;
            margin-bottom: 10px;
        }
        button {
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        #fullResultsDump {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ccc;
            padding: 10px;
            margin-top: 20px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
</head>
<body>
    <h1>Google Sheets Autocomplete Widget Sandbox</h1>
    
    <div id="widgetContainer">
        <iframe id="widgetFrame" src="index.html"></iframe>
    </div>
    
    <div id="controls">
        <h2>Widget Settings</h2>
        <label for="googleSheetId">Google Sheet ID (or 'test' for test API):</label>
        <input type="text" id="googleSheetId" value="1Xg_6DlbHku0zBiHhm54uDsubVpZDA5ELzl9rQcMS7j8">
        
        <label for="columnIndex">Column Index:</label>
        <input type="number" id="columnIndex" value="1" min="0">
        
        <label for="placeholderText">Placeholder Text:</label>
        <input type="text" id="placeholderText" value="Start typing...">
        
        <label for="inputWidth">Input Width:</label>
        <input type="text" id="inputWidth" value="100%">
        
        <label for="autocompleteWidth">Autocomplete Width:</label>
        <input type="text" id="autocompleteWidth" value="100%">
        
        <label for="dynamicResize">Dynamic Resize:</label>
        <select id="dynamicResize">
            <option value="true">True</option>
            <option value="false">False</option>
        </select>
        
        <label for="threshold">Search Threshold:</label>
        <input type="number" id="threshold" value="0.4" min="0" max="1" step="0.1">
        
        <label for="distance">Search Distance:</label>
        <input type="number" id="distance" value="100" min="0">
        
        <label for="maxResults">Max Results:</label>
        <input type="number" id="maxResults" value="5" min="1">
        
        <label for="minCharRequired">Minimum Characters Required:</label>
        <input type="number" id="minCharRequired" value="2" min="1">
        
        <label for="debounceTime">Debounce Time (ms):</label>
        <input type="number" id="debounceTime" value="300" min="0">
        
        <button onclick="updateWidget()">Update Widget</button>
    </div>

    <div id="fullResultsDump"></div>

    <script>
        function updateWidget() {
            const settings = {
                googleSheetId: document.getElementById('googleSheetId').value,
                columnIndex: parseInt(document.getElementById('columnIndex').value),
                placeholderText: document.getElementById('placeholderText').value,
                inputWidth: document.getElementById('inputWidth').value,
                autocompleteWidth: document.getElementById('autocompleteWidth').value,
                dynamicResize: document.getElementById('dynamicResize').value === 'true',
                threshold: parseFloat(document.getElementById('threshold').value),
                distance: parseInt(document.getElementById('distance').value),
                maxResults: parseInt(document.getElementById('maxResults').value),
                minCharRequired: parseInt(document.getElementById('minCharRequired').value),
                debounceTime: parseInt(document.getElementById('debounceTime').value)
            };

            const iframe = document.getElementById('widgetFrame');
            iframe.contentWindow.postMessage({ type: 'updateSettings', settings: settings }, '*');
        }

        window.addEventListener('message', function(event) {
            if (event.data.type === 'resize') {
                const iframe = document.getElementById('widgetFrame');
                iframe.style.height = event.data.height + 'px';
            } else if (event.data.type === 'fullResults') {
                displayFullResults(event.data.results);
            }
        });

        function displayFullResults(results) {
            const dumpContainer = document.getElementById('fullResultsDump');
            dumpContainer.innerHTML = `<h3>Full Results from Google Sheet (Total Rows: ${results.length})</h3>`;
            const list = document.createElement('ul');
            
            // Display first 100 rows
            for (let i = 0; i < Math.min(100, results.length); i++) {
                const item = document.createElement('li');
                item.textContent = `Row ${i + 1}: ${JSON.stringify(results[i])}`;
                list.appendChild(item);
            }
            
            // If there are more than 100 rows, add a message
            if (results.length > 100) {
                const moreItem = document.createElement('li');
                moreItem.textContent = `... and ${results.length - 100} more rows`;
                list.appendChild(moreItem);
            }
            
            dumpContainer.appendChild(list);
        }

        // Initialize the widget with default settings when the page loads
        window.onload = function() {
            updateWidget();
        };
    </script>
</body>
</html>
